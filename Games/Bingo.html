<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kerst Bingo ðŸŽ„</title>

<script>
let autoRefreshEnabled = true;
window.addEventListener("load", () => {
    setTimeout(() => {
        if (autoRefreshEnabled) location.reload();
    }, 60000);
});
</script>

<style>
body {
    margin: 0;
    font-family: "Segoe UI", Arial, sans-serif;
    background: linear-gradient(145deg, #0f0f0f, #2b0000 40%, #145214 90%);
    background-size: 250% 250%;
    animation: bgFlow 16s ease infinite;
    color: #fff;
    overflow: hidden;
}
@keyframes bgFlow {
    0% { background-position: 0% 0%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 0%; }
}
h1 {
    margin-top: 25px;
    font-size: 42px;
    font-weight: 800;
    text-shadow: 0 4px 14px rgba(255,0,0,0.4);
}

/* BIG BALL V2.4 */
#ball {
    position: absolute;
    top: 55%;
    left: 50%;
    width: 420px;
    height: 420px;
    transform: translate(-50%, -50%) scale(0);
    background: radial-gradient(circle, #ffffff 45%, #d8d8d8 80%);
    border: 14px solid red;
    border-radius: 50%;
    box-shadow: 0 0 45px red, inset 0 0 30px rgba(0,0,0,0.45);
    display: flex;
    justify-content: center;
    align-items: center;
}
@keyframes swooshBall {
    0% { transform: translate(-50%,-50%) scale(0.2); opacity:0.2; filter: blur(20px); }
    45% { transform: translate(-50%,-42%) scale(1.4); opacity:0.8; }
    75% { transform: translate(-50%,-50%) scale(0.95); opacity:1; }
    100% { transform: translate(-50%,-50%) scale(1); opacity:1; }
}
.swooshActive {
    animation: swooshBall .95s cubic-bezier(.18,.61,.53,1) forwards;
}
#numberText {
    font-size: 160px;
    font-weight: 900;
    color: #000;
}
#versionBadge {
    position: fixed;
    bottom: 10px;
    right: 10px;
    font-size: 13px;
    font-weight: bold;
    color: #00ff00;
}
#settingsPanel {
    display:none;
    position:fixed;
    top:80px;
    left:50%;
    transform:translateX(-50%);
    background:#111;
    padding:20px;
    border:2px solid red;
    z-index:9999;
    color:white;
}
input[type=range] { width:100%; }
</style>
</head>

<body>

<h1>ðŸŽ… Kerst Muziek Bingo ðŸŽ„</h1>

<div id="settingsPanel">
<h2>Instellingen ðŸŽ„</h2>
<label>Nummer limiet: <span id="rangeValue">75</span></label>
<input type="range" min="10" max="100" value="75" id="numberRange"><br><br>

<label>Text-To-Speech: <input type="checkbox" id="ttsToggle"></label><br>
<label>Stem selecteren: <select id="voiceSelect"></select></label>
</div>

<div id="ball"><span id="numberText"></span></div>
<div id="versionBadge">V2.4</div>

<script>
let usedNumbers=[];
let voices=[];
let maxNumber = Number(localStorage.getItem("max"))||75;
let cooldownActive=false;
let ttsEnabled = localStorage.getItem("tts")==="true";
let mode = localStorage.getItem("mode")||"pro";

const synth = window.speechSynthesis;
const ball = document.getElementById("ball");
const numberText = document.getElementById("numberText");
const settingsPanel = document.getElementById("settingsPanel");
const ttsToggle = document.getElementById("ttsToggle");
const voiceSelect = document.getElementById("voiceSelect");
const numberRange = document.getElementById("numberRange");
const rangeValue = document.getElementById("rangeValue");

/* Neon kleuren */
const neonColors = ["green","red","blue","yellow"];
let neonIndex = 0;
function applyNextNeonColor(){
    const c = neonColors[neonIndex];
    ball.style.borderColor = c;
    ball.style.boxShadow = `0 0 50px ${c}, inset 0 0 30px rgba(0,0,0,0.45)`;
    neonIndex = (neonIndex + 1) % neonColors.length;
}

/* Range & TTS settings */
numberRange.value=maxNumber;
rangeValue.textContent=maxNumber;
ttsToggle.checked=ttsEnabled;

numberRange.oninput=()=>{ rangeValue.textContent=numberRange.value; maxNumber=Number(numberRange.value); localStorage.setItem("max",maxNumber);}
ttsToggle.onchange=()=>{ ttsEnabled=ttsToggle.checked; localStorage.setItem("tts",ttsEnabled); }

function loadVoices(){
    voices = synth.getVoices();
    voiceSelect.innerHTML="";
    voices.forEach((v,i)=>{
        let opt = document.createElement("option");
        opt.value=i; opt.textContent=v.name;
        voiceSelect.appendChild(opt);
    });
    if(localStorage.getItem("voiceIndex")) voiceSelect.value=localStorage.getItem("voiceIndex");
}
loadVoices();
speechSynthesis.onvoiceschanged=loadVoices;
voiceSelect.onchange=()=>localStorage.setItem("voiceIndex",voiceSelect.value);

/* Key controls */
document.body.addEventListener("keydown", e=>{
    if(e.code==="Space"){
        e.preventDefault();
        triggerNext();
    }
    if(e.ctrlKey && e.key==="1"){
        e.preventDefault();
        settingsPanel.style.display = settingsPanel.style.display==="block"?"none":"block";
    }
});

async function triggerNext(){
    if(cooldownActive) return;
    cooldownActive=true;
    ball.style.transform="translate(-50%,-50%) scale(1)";
    numberText.textContent=""; // leeg maken voor TTS
    setTimeout(()=>cooldownActive=false,5000);
    await generateNumber();
}

async function generateNumber(){
    if(usedNumbers.length>=maxNumber){
        alert("Alle nummers zijn geweest ðŸŽ‰");
        return;
    }

    let num;
    do{
        num=Math.floor(Math.random()*maxNumber)+1;
    }while(usedNumbers.includes(num));

    usedNumbers.push(num);

    applyNextNeonColor();
    ball.classList.remove("swooshActive");
    void ball.offsetHeight;
    ball.classList.add("swooshActive");

    if(ttsEnabled){
        const msg = new SpeechSynthesisUtterance(`Volgende nummer. ${num}. Ik herhaal. ${num}.`);
        msg.voice = voices[voiceSelect.value];
        numberText.textContent = num; // nummer tonen wanneer TTS start
        msg.onend = ()=>{ ball.style.transform="translate(-50%,-50%) scale(0)"; };
        synth.speak(msg);
        // geluids effect tegelijk
        const audio=new Audio("./Sounds/Noti.mp3");
        audio.volume=1.0;
        audio.play();
    } else {
        numberText.textContent = num;
        const audio=new Audio("./Sounds/Noti.mp3");
        audio.volume=1.0;
        audio.onended=()=>{ setTimeout(()=>ball.style.transform="translate(-50%,-50%) scale(0)",8000); };
        audio.play();
    }
}
</script>

</body>
</html>
