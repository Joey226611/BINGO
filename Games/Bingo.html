<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kerst Bingo üéÑ</title>

<!-- AUTO REFRESH SCRIPT -->
<script>
let autoRefreshEnabled = true;
window.addEventListener("load", () => {
    setTimeout(() => {
        if (autoRefreshEnabled) location.reload();
    }, 60000);
});
</script>

<style>
body {
    margin: 0;
    font-family: "Segoe UI", Arial, sans-serif;
    background: linear-gradient(145deg, #0f0f0f, #2b0000 40%, #145214 90%);
    background-size: 250% 250%;
    animation: bgFlow 16s ease infinite;
    color: #fff;
    overflow: hidden;
}

@keyframes bgFlow {
    0% { background-position: 0% 0%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 0%; }
}

h1 {
    margin-top: 25px;
    font-size: 42px;
    font-weight: 800;
    text-shadow: 0 4px 14px rgba(255,0,0,0.4);
}

#ball {
    position: absolute;
    top: 55%;
    left: 50%;
    width: 420px;
    height: 420px;
    transform: translate(-50%, -50%) scale(0);
    background: radial-gradient(circle, #ffffff 45%, #d8d8d8 80%);
    border: 14px solid red;
    border-radius: 50%;
    box-shadow: 0 0 45px red, inset 0 0 30px rgba(0,0,0,0.45);
    display: flex;
    justify-content: center;
    align-items: center;
}

@keyframes swooshBall {
    0% { transform: translate(-50%,-50%) scale(0.2); opacity:0.2; filter: blur(20px); }
    45% { transform: translate(-50%,-42%) scale(1.4); opacity:0.8; }
    75% { transform: translate(-50%,-50%) scale(0.95); opacity:1; }
    100% { transform: translate(-50%,-50%) scale(1); opacity:1; }
}
.swooshActive {
    animation: swooshBall .95s cubic-bezier(.18,.61,.53,1) forwards;
}

#numberText {
    font-size: 160px;
    font-weight: 900;
    color: #000;
}

#versionBadge {
    position: fixed;
    bottom: 10px;
    right: 10px;
    font-size: 13px;
    font-weight: bold;
    color: #00ff00;
}

/* SETTINGS PANEL */
#settingsPanel{
    display:none;
    position:fixed;
    top:90px;
    left:50%;
    transform:translateX(-50%);
    background:#111;
    padding:25px;
    border-radius:16px;
    border:2px solid red;
    box-shadow:0 0 30px red;
    z-index:9999;
    width:320px;
}
#settingsPanel h2{margin-top:0;color:#0f0;}
#settingsPanel input,#settingsPanel select{
    width:100%;
    margin-top:5px;
    padding:6px;
}
#settingsPanel button{
    width:100%;
    padding:10px;
    margin-top:15px;
    background:red;
    border:none;
    color:white;
    font-weight:bold;
    border-radius:10px;
    cursor:pointer;
}
</style>
</head>

<body>

<h1>üéÖ Kerst Muziek Bingo üéÑ</h1>

<div id="settingsPanel">
<h2>‚öôÔ∏è Instellingen</h2>

<label>
Max nummers:
<input id="maxInput" type="number" min="1" max="100">
</label>

<br><br>

<label>
<input id="ttsToggle" type="checkbox">
 Text To Speech
</label>

<br><br>

<label>
Stem:
<select id="voiceSelect"></select>
</label>

<button onclick="saveSettings()">Opslaan</button>
</div>

<div id="ball"><span id="numberText"></span></div>
<div id="versionBadge">V2.4</div>

<script>
let usedNumbers=[];
let voices=[];
let ttsEnabled = localStorage.getItem("tts")==="true";
let maxNumber = Number(localStorage.getItem("max"))||75;
let cooldownActive=false;

const synth = window.speechSynthesis;
const ball = document.getElementById("ball");
const numberText = document.getElementById("numberText");
const settingsPanel = document.getElementById("settingsPanel");

const maxInput = document.getElementById("maxInput");
const ttsToggle = document.getElementById("ttsToggle");
const voiceSelect = document.getElementById("voiceSelect");

maxInput.value = maxNumber;
ttsToggle.checked = ttsEnabled;

/* NEON */
const neonColors = ["green","red","blue","yellow"];
let neonIndex = 0;
function applyNextNeonColor(){
    const c = neonColors[neonIndex];
    ball.style.borderColor = c;
    ball.style.boxShadow = `0 0 50px ${c}, inset 0 0 30px rgba(0,0,0,0.45)`;
    neonIndex = (neonIndex + 1) % neonColors.length;
}

/* KEYBOARD */
document.addEventListener("keydown", e=>{
    if(e.code==="Space"){
        e.preventDefault();
        triggerNext();
    }
    if(e.ctrlKey && e.key==="1"){
        e.preventDefault();
        settingsPanel.style.display =
            settingsPanel.style.display==="block"?"none":"block";
    }
});

/* VOICES */
function loadVoices(){
    voices = synth.getVoices();
    voiceSelect.innerHTML="";
    voices.forEach((v,i)=>{
        const o=document.createElement("option");
        o.value=i;
        o.textContent=`${v.name} (${v.lang})`;
        voiceSelect.appendChild(o);
    });
    const saved=localStorage.getItem("voiceIndex");
    if(saved!==null) voiceSelect.value=saved;
}
loadVoices();
speechSynthesis.onvoiceschanged = loadVoices;

function saveSettings(){
    maxNumber = Number(maxInput.value);
    ttsEnabled = ttsToggle.checked;
    localStorage.setItem("max",maxNumber);
    localStorage.setItem("tts",ttsEnabled);
    localStorage.setItem("voiceIndex",voiceSelect.value);
    settingsPanel.style.display="none";
}

async function triggerNext(){
    autoRefreshEnabled=false;
    if(cooldownActive) return;
    cooldownActive=true;
    setTimeout(()=>cooldownActive=false,5000);
    generateNumber();
}

function generateNumber(){
    if(usedNumbers.length>=maxNumber){
        alert("Alle nummers zijn geweest üéâ");
        return;
    }
    let num;
    do{
        num=Math.floor(Math.random()*maxNumber)+1;
    }while(usedNumbers.includes(num));

    usedNumbers.push(num);
    numberText.textContent=num;

    applyNextNeonColor();
    ball.classList.remove("swooshActive");
    ball.offsetHeight;
    ball.classList.add("swooshActive");
    ball.style.transform="translate(-50%,-50%) scale(1)";

    const audio=new Audio("./Sounds/Noti.mp3");
    audio.onended=()=>{
        if(ttsEnabled){
         const u = new SpeechSynthesisUtterance(
    `Volgende nummer. ${num}. Ik herhaal. ${num}.`
);

            const vi=localStorage.getItem("voiceIndex");
            if(voices[vi]) u.voice=voices[vi];
            synth.speak(u);
        }
        setTimeout(()=>ball.style.transform="translate(-50%,-50%) scale(0)",8000);
    };
    audio.play();
}
</script>

</body>
</html>
